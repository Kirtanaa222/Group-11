<!DOCTYPE html>
<html>
<head>
    <title>Study Space</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='Style.css') }}">
</head>
<body>
    <input type="checkbox" id="menu-toggle" hidden>
    <label for="menu-toggle" class="openbtn">Settings</label>

    <div id="mySidenav" class="sidenav">
        <label for="menu-toggle" class="closebtn">&times;</label>

        <!-- Sidenav Profile Section -->
        <div class="sidenav-profile">
            <a href="{{ url_for('display_profile', user_id=session['user_id']) }}">
                <img src="{{ url_for('static', filename=avatar) }}" alt="Avatar">
            </a>
        </div>
        <a href="{{ url_for('home') }}">Home</a>
        <a href="{{ url_for('study_space') }}">Study Space</a>
        <a href="{{ url_for('message') }}">Chatroom</a>
        <a href="{{ url_for('logout') }}">Logout</a>
    </div>

    <div class="search-bar-group">
        <form class="faculty-search" method="get" action="{{ url_for('search_users') }}">
            <label for="search" class="search-label">Find your studybae:</label>
            <select name="faculty">
                <option value="">All Faculties</option>
                <option value="Faculty Of Applied Communication (FAC)">FAC</option>
                <option value="Faculty Of Artificial Intelligence And Engineering (FAIE)">FAIE</option>
                <option value="Faculty Of Business (FOB)">FOB</option>
                <option value="Faculty Of Cinematic Arts (FCA)">FCA</option>
                <option value="Faculty Of Computing and Informatics (FCI)">FCI</option>
                <option value="Faculty Of Creative Multimedia (FCM)">FCM</option>
                <option value="Faculty Of Engineering and Technology (FET)">FET</option>
                <option value="Faculty Of Information Science and Technology (FIST)">FIST</option>
                <option value="Faculty Of Law (FOL)">FOL</option>
                <option value="Faculty Of Management (FOM)">FOM</option>
            </select>
            <input type="text" name="subject" placeholder="Enter subject (e.g. Math)" value="{{ request.args.get('subject', '') }}">
            <button type="submit">Search</button>
        </form>
    </div>

    <div class="main">
        
        {% if mmu_reminder %}
        <div class="mmu-reminder">
            <p>{{ mmu_reminder }}</p>
            <a href="{{ url_for('edit_profile', user_id=session['user_id']) }}">Update MMU Email</a>
        </div>
        {% endif %}

        <h1>Welcome, {{ username }}</h1>

            <!-- Show admin dashboard link if user is admin -->
        {% if session.get('is_admin') %}
            <p><a href="{{ url_for('admin_dashboard') }}" class="admin-btn pink-btn back-btn">Go to Admin Dashboard</a></p>
        {% endif %}
    </div>

    <div class="timetable-section">
        <h2>Your Timetable</h2>
        <table>
            <tr>
                <th>Date</th>
                <th>Day</th>
                <th>Start</th>
                <th>End</th>
                <th>Subject</th>
                <th>Description</th>
            </tr>
            {% for entry in timetable_entries %}
            <tr>
                <td>{{ entry.date.strftime('%Y-%m-%d') if entry.date else '' }}</td>
                <td>{{ entry.day_of_week }}</td>
                <td>{{ entry.start_time.strftime('%H:%M') }}</td>
                <td>{{ entry.end_time.strftime('%H:%M') }}</td>
                <td>{{ entry.subject }}</td>
                <td>{{ entry.description or '' }}</td>
            </tr>
            {% endfor %}
        </table>
        <p><a href="{{ url_for('timetable') }}">Edit Timetable</a></p>
    </div>

</body>
</html>